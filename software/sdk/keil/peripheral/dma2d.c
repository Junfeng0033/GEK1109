
/****************************************************************************
 *   $Id:: dma.c 2020-07-15 
 *   Project: Gecko DMA driver
 *	 Author: Moana/JF
 *   Description: 
****************************************************************************/

#include "gecko1108.h"
#include "dma2d.h"
#include "spi.h"
#include "lcd_driver.h"
#include "gpio.h"


extern uint32 pEnterCriticalSection (void);
extern void pExitCriticalSection (uint32 status);

extern void NVIC_EnableIRQ(IRQn_Type IRQn);
extern void NVIC_DisableIRQ(IRQn_Type IRQn);

void dma2d_memcopy(uint32_t pixelformat, void * psrc, void * pdst, int width, int height, int offLinesrc, int offLinedst)
{
    
    DMA2D->CR      = 0x00000000UL;
    DMA2D->FGMAR   = (uint32_t)psrc;
    DMA2D->OMAR    = (uint32_t)pdst;
    DMA2D->FGOR    = offLinesrc;
    DMA2D->OOR     = offLinedst;
    DMA2D->FGPFCCR = pixelformat;
    DMA2D->NLR     = (uint32_t)(width << 16) | (uint16_t)height;

    //DMA2D->CR   |= DMA2D_CR_START;

    //while (DMA2D->CR & DMA2D_CR_START) {}
}




void DMA_Configuration(void)
{
	volatile uint32 dma_ctrl;
	
	dma_ctrl=0;
	
	dma_ctrl = DMA_READ_REG(AHB_DMA_STEP_CTRL_REG);
	
	dma_ctrl |= dma_for_dac_en;

	DMA_WRITE_REG((volatile uint32 *)AHB_DMA_STEP_CTRL_REG, dma_ctrl);

	dma_ctrl |= dma_int_mask;

	DMA_WRITE_REG((volatile uint32 *)AHB_DMA_STEP_CTRL_REG, dma_ctrl);

	hal_nvic_clear_pending_irq(DMA_IRQn);
	
	hal_nvic_set_priority(DMA_IRQn, 0);
	
	NVIC_EnableIRQ(DMA_IRQn);
}



void Clear_DMA_Interrupt(void)
{
	volatile uint32 dma_ctrl_tmp0=0;
	
	dma_ctrl_tmp0 |=dma_int_clear;
	
	dma_ctrl_tmp0 |=dma_int_mask;

	dma_ctrl_tmp0 |=dma_for_dac_en;
	DMA_WRITE_REG((volatile uint32 *)AHB_DMA_STEP_CTRL_REG,dma_ctrl_tmp0);	
}




__RAM_CODE__ void Gecko_DMA_Transport(volatile void *dest,volatile const void *src, uint16 size,uint8 type, uint8 direct)
{
	volatile uint32 dma_statu,dma_ctrl;//cpu_flags;

	uint32 status = pEnterCriticalSection();

	dma_statu=DMA_READ_REG(AHB_DMA_DONE_STS_REG);
	dma_statu=DMA_READ_REG(AHB_DMA_STEP_CTRL_REG);
	
    //SYSirq_Disable_Interrupts_Save_Flags(&cpu_flags);

    DMA_WRITE_REG((volatile uint32 *)AHB_DMA_SRCADDR_REG, (uint32) src);
    DMA_WRITE_REG((volatile uint32 *)AHB_DMA_DESTADDR_REG, (uint32) dest);
    DMA_WRITE_REG((volatile uint32 *)AHB_DMA_DATALENGTH_REG, size);
    DMA_WRITE_REG((volatile uint32 *)AHB_DMA_CONTROL_REG,(type|direct));
    //SYSirq_Interrupts_Restore_Flags(cpu_flags);
	  pExitCriticalSection(status);
}







extern void HW_SPI_Tx_DMA(HAL_SPI_ID_T id,uint16 *pData, uint16 DataLen);



uint16 location = 0;

__RAM_CODE__ void DMA_ISR_Routine(void)
{
	volatile uint32 dma_ctrl_tmp1=0;
	
	dma_ctrl_tmp1 |= dma_int_clear;//clear interrupt
	
	dma_ctrl_tmp1 |= dma_int_mask; //maintain dma_int_mask bit "1"

	dma_ctrl_tmp1 |= dma_for_dac_en;
	
	DMA_WRITE_REG((volatile uint32 *)AHB_DMA_STEP_CTRL_REG, dma_ctrl_tmp1);		

	//HW_SPI_Tx_Block(HAL_SPI_0,sine12bit,POINT_NUM);

	LCD_RS_SET;


//	if(location)
//		HW_SPI_Tx_DMA(HAL_SPI_0, gImage_libai, 25600);
//	else 
//		HW_SPI_Tx_DMA(HAL_SPI_0, gImage_taizi, 25600);
	
	location = ~location;
}








/*****************************************************************************
 * FUNCTION: hw_memcpy8
 *
 * byte (8 bit) direct copy
 *
 * dest     address of destination  (byte aligned)
 * src      address of source       (byte aligned)
 * size     in bytes   
 *****************************************************************************/
void * hw_memcpy8(void * dest, const void * src, uint16 size)
{
#if 1//GEK_DMA_ENABLE
    if(size > GECKO_DMA_MIN_SIZE)
    {
       Gecko_DMA_Transport(dest,src,size,AHB_DMA_CONTROL_HWORD_TR, AHB_DMA_CONTROL_SRC_INC_DES_INC); 
    }else
#endif
    {
        uint8 *_u8_dest = (uint8 *) dest;
        uint8 *_u8_end  = (uint8 *) dest + size;
			
        uint8 *_u8_src  = (uint8 *) src;

        while (_u8_dest < _u8_end)
        {
            *_u8_dest++ = *_u8_src++;
        }
    }

    return dest;
}




/*****************************************************************************
 * FUNCTION: hw_memset8
 *
 * DESCRIPTION: 8-bit memset where value is written size times at dest
 *****************************************************************************/
void hw_memset8(void * dest, uint8 value, uint16 size)
{
    uint8 *_u8_dest = (uint8 *)dest;
    uint8 *_u8_end  = (uint8 *)dest + size;

#if GEK_DMA_ENABLE
    if(size > GECKO_DMA_MIN_SIZE)
    {
//        size= ((size + 2) >> 1);
        Gecko_DMA_Transport(dest,&value, size,AHB_DMA_CONTROL_BYTE_TR, AHB_DMA_CONTROL_SRC_NOINC_DES_INC); 
    }else
#endif

    while (_u8_dest < _u8_end)
    {
        *_u8_dest++ = value;
    }
}












#define USB_BASE_ADDR 		0X80000000
#define M_FIFO_EP0			USB_BASE_ADDR + 32

/****************************************
  FIFORead
****************************************/
void FIFORead (int nEP, int nBytes, volatile void * pDst)
{
    int     nCount;
    BYTE *  pby;
    int     nAddr;

    if (nBytes)
    {
        nAddr = M_FIFO_EP0+(nEP<<2);
        nCount = nBytes;
        pby = (BYTE *)pDst;

#if GEK_DMA_ENABLE
        if(nCount > GECKO_DMA_MIN_SIZE)
        {
            Gecko_DMA_Transport((volatile uint32 *)pby,
            (volatile uint32 *)(nAddr ),
            nCount, AHB_DMA_CONTROL_BYTE_TR, AHB_DMA_CONTROL_SRC_NOINC_DES_INC);
        }
        else
#endif
        {
            while (nCount) {
                *pby++ = *((BYTE *)nAddr);
                nCount--;
            }
        }
    }
    return;
}

/****************************************
  FIFOWrite
****************************************/
void FIFOWrite (int nEP, int nBytes, volatile void * pSrc)
{
    int     nCount;
    BYTE *  pby;
    int     nAddr;

    if (nBytes)
    {
        nAddr = M_FIFO_EP0+(nEP<<2);
        nCount = nBytes;
        pby = (BYTE *)pSrc;

#if GEK_DMA_ENABLE
        if(nBytes > GECKO_DMA_MIN_SIZE)
        {
            Gecko_DMA_Transport((volatile uint32 *)(nAddr ), (volatile uint32 *)pby, nCount, AHB_DMA_CONTROL_BYTE_TR, AHB_DMA_CONTROL_SRC_INC_DES_NOINC);
        }
        else
#endif
        {
            while (nCount) {
               *((BYTE *)nAddr) = *pby++;
               nCount--;
            }
        }
    }
    return;
}






#if 0

#define    AHB_CODEC_BASE                   0X80000000

#if (PRODUCT==STEREO_HEADSET)

static uint8 testdata[][420] = 
{
 {0xff,0xfb,0x92,0x0, 0xc, 0xf, 0xf2,0x95,0xb, 0xc6,0x7, 0x7f,0x60,0x0, 0x54,0x21,0x68,0xe0,0xef,0xe8,0x0, 0xa, 0x14,0x2d,0x18,0xd, 0xf7,0xe4,0x81,0x1f,0x85,0xa3,0x41,0xae,0x7c,0x90,0x68,0x3f,0x6, 0x1a,0x48,0xbd,0x86,0x43,0xe9,0x16,0x46,0x44,0xef,0x8, 0x47,0x9, 0xba,0x2c,0x26,0x2b,0xd0,0x48,0x86,0x14,0x28,0x26,0x46,0x9, 0x88,0x31,0x86,0x6, 0xd8,0xe, 0x26,0x86,0xfa,0x73,0x88,0x26,0x38,0x42,0x5e,0xf, 0x76,0xb7,0xff,0xff,0xfd,0x7e,0xef,0xff,0xff,0xff,0xfd,0x4e,0xff,0xff,0x55,0xef,0xcb,0x31,0x40,0x0, 0x8c,0x6, 0xa0,0x7, 0xcc,0x6, 0xc0,0x3c,0x4c,0x12,0xe0,0x43,0xcc,0xe, 0x0, 0x19,0xcc,0xa, 0x40,0x5e,0xcc,0x29,0x21,0x1f,0xcc,0x61,0x61,0x75,0xcc,0x5c,0xa, 0xa, 0x4e,0x6, 0xa3,0x11,0x8c,0x24,0xf0,0xbc,0x4c,0x26,0xc0,0x4c,0xcc,0x10,0xe0,0x49,0xcc,0x7, 0x40,0x22,0xe, 0xa3,0xe3,0xde,0xd8,0xce,0x9e,0x1a,0xf, 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xdb,0xff,0xff,0xff,0xff,0xff,0xff,0xf4,0xff,0xa2,0x8b,0xf5,0x89,0x8, 0xe9,0xc1,0x8f,0x18,0x3c,0x16,0x98,0x6a,0x24,0x18,0xac,0x2b,0x99,0x18,0x4d,0x99,0x9a,0x84,0x1b,0x25,0x3e,0x98,0xb7,0xb7,0x89,0x1f,0x73,0x23,0x99,0x98,0x60,0xe0,0xcc,0x18,0x22,0x0, 0x55,0x98,0xf, 0x20,0x21,0x4, 0x0, 0x8a,0x23,0x0, 0x28,0xc0,0xc, 0x0, 0x34,0x4, 0x0, 0x52,0xb9,0xf6,0xff,0xff,0xff,0xe8,0xf4,0x7f,0xff,0xff,0xfe,0xcf,0xff,0xfb,0x3f,0xfe,0xde,0xcf,0xf4,0x7f,0xa3,0xfd,0x37,0xbf,0xf2,0x20,0x34,0x77,0xd, 0x98,0x44,0x50,0x62,0x42,0x9, 0x90,0xc9,0x6, 0x79,0x3e,0x1a,0xe9,0x96,0x77,0xdf,0x31,0x8a,0xf9,0x21,0x69,0xf2,0x24,0x2c,0x11,0x85,0xc8,0x9, 0x89,0x82,0xe, 0x3, 0xc1,0x80,0xec,0x1, 0x28,0xb0,0xa, 0x63,0xa0,0x7, 0x80,0x40,0xc, 0x2d,0x2b,0x12,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xed,0xff,0xff,0xb7,0xff,0xec,0xff,0xff,0xfa,0x6a,0xbd,0xfa,0xba,0x4a,0xf9,0xf3,0x1, 0x81,0x5, 0xe6,0x15,0x22,0x18,0xd0,0x8e,0x67,0x43,0x39,0xb1,0x52,0x87,0xa0,0xaa,0x98,0xc1,0xac,0xbb,0x1f,0xdc,0xe1,0xed,0x98,0x66,0xa0,0x66,0x18,0x24,0xc0,0x22,0x81,0x81,0x1a,0x30,0xf, 0x0, 0xc, 0x0, 0x0, 0x34,0x28,0x0, 0x98,0x84,0x0, 0x6, 0xb2,0xde,0xdf,0xff,0xff,0xfd,0x9f,0xff,0xff,0xff,0xfd,0x9f,0xff,0xf6,0x7f,0xfd,0xbf,0xff,0xff,0x41,0xe
,0x2c,0x1, 0xdb,0x61,0x51,0x31,0x81,0x7, 0x66,0x0},
 {0xff,0xfb,0x92,0x0, 0x2b,0xf, 0xf2,0x55,0xb, 0x46,0x83,0x3c,0xf9,0x20,0x36,0x1, 0x68,0xe0,0x4f,0x9f,0x24,0x8, 0xd4,0x2d,0x1c,0x9, 0xf3,0xe4,0x80,0xed,0x85,0xe3,0x81,0x3f,0xf0,0x98,0x23,0x1b,0x19,0x74,0x90,0x6a,0xa2,0xe9,0xdd,0x59,0x86,0x2b,0xc1,0xf2,0xe7,0xc8,0x70,0x4a,0x46,0x17,0x20,0xd, 0xe6,0x8, 0x48,0x2, 0xc2,0xc0,0x80,0x18,0x7, 0x60,0x9, 0x98,0x0, 0x60,0xc, 0x90,0x0, 0x1c,0x8e,0xae,0x91,0xed,0x61,0x1d,0x82,0x5c,0x2a,0x9, 0xc4,0x63,0x63,0x8, 0xb, 0x4c,0xa0,0x2d,0x35,0x38,0x50,0x5d,0xda,0x62,0xc9,0x84,0x72,0x7d,0x13,0x80,0x7c,0x61,0x7a,0x80,0x6, 0x60,0x88,0x0, 0x10,0x60,0x44,0x80,0x2a,0x60,0x22,0x0, 0x48,0x60,0x7, 0x0, 0x3c,0xd, 0x0, 0x45,0xf, 0x1e,0xb6,0xff,0xff,0xff,0xfe,0xcf,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfa,0xf, 0x6a,0x9, 0xe8,0xd, 0x7d,0x11,0x0, 0x4c,0x42,0x1, 0xa9,0x80,0x6, 0x1, 0x31,0x80,0x8e,0x0, 0xb0,0x28,0x13,0xc3,0x5, 0xc4,0x7, 0xb3,0x16,0x10,0xc1,0xa3,0xe6,0x60,0x1c,0x73,0xb, 0xb0,0x5, 0xa3,0x87,0x8b,0x4d,0x10,0x24,0x32,0x38,0xb4,0xc2,0xa2,0x30,0x0, 0x41,0x4, 0x6f,0x6, 0xbf,0xff,0xff,0xff,0x5d,0xbd,0xfa,0xd9,0x23,0xe7,0xf4,0x6, 0x3, 0x15,0x98,0x10,0x6c,0x54,0xf, 0x94,0x1d,0x4d,0x4a,0x5b,0x3c,0x65,0x38,0xc5,0xf7,0x6c,0xbc,0xfe,0x39,0x10,0x70,0xc3,0x2d,0x3, 0xa4,0xc1,0x2a,0x1, 0xb8,0xc0,0x9b,0x1, 0x2c,0xc0,0x58,0x1, 0x8, 0xc0,0x22,0x0, 0xb0,0xc0,0xf, 0x0, 0x5c,0x10,0x0, 0x3, 0x5b,0x6f,0x47,0xff,0xff,0xfe,0xcf,0xff,0xff,0xff,0xfe,0x9f,0xff,0xfa,0x7f,0xff,0xff,0xff,0xfa,0xf, 0x6a,0x8, 0x4d,0x1, 0xd5,0x3a,0x60,0xa1,0x31,0x84,0x45,0xe0,0x80,0x91,0x8a,0x41,0x66,0x94,0x42,0x1d,0xcf,0x56,0x62,0xd0,0x43,0x24,0x7d,0x72,0xa, 0x36,0x61,0x7f,0x2, 0x44,0x60,0x8d,0x81,0x12,0x60,0x4a,0x0, 0xac,0x60,0x2c,0x80,0x8e,0x60,0x13,0x80,0x5a,0x60,0xa, 0x0, 0x28,0x59,0x36,0x20,0xce,0x9f,0xff,0xff,0xfd,0xbf,0xff,0xff,0xff,0xfd,0x1f,0xff,0xf4,0x51,0x7f,0xe6,0x38,0x36,0x70,0xc3,0x86,0x0, 0xf8,0x4, 0xa6,0x1, 0x40,0x5, 0x0, 0x60,0xe, 0xcc,0x0, 0x80,0x10,0xc, 0x8, 0x30,0x37,0x4c,0x16,0x60,0x9e,0xc, 0x58,0xbc,0x18,0x4f,0xa1,0x51,0xd9,0x8c,0x2f,0x50,0x6b,0x4e,0x30,0xca,0x34,0xd9,0xec,0xcc,0x45,0xa3,0x1
, 0x8c,0x4a,0x17,0x1, 0x5, 0x15,0xde,0xdf,0xdd,0x0},
 {0xff,0xfb,0x92,0x0, 0x68,0x8f,0xf2,0x62,0xb, 0x46,0x83,0x3c,0xf9,0x20,0x46,0xe1,0x68,0xd0,0x53,0x9f,0x24,0x9, 0xd8,0x2f,0x18,0xd, 0xff,0x84,0xc1,0x42,0x85,0xe2,0xc1,0xbf,0xf0,0x98,0xff,0xff,0xf5,0x7f,0xff,0xff,0xff,0xff,0xbf,0xff,0xfe,0xff,0xff,0xfb,0xff,0xff,0xd5,0x45,0xff,0x80,0xe8,0xd1,0xd7,0x8e,0x98,0x5, 0x80,0x12,0x18,0x7, 0xa0,0x11,0x93,0x0, 0xda,0x48,0x3, 0x49,0x80,0xec,0x9, 0x11,0x82,0xc6,0x19,0x19,0x8b,0x21,0xe3,0xb1,0xf4,0xd4,0x4a,0x39,0x85,0xf0,0x10,0xe1,0xc7,0x60,0x26,0xa0,0x4c,0x19,0xbc,0xd6,0x64,0x11,0xd9,0x8c,0x83,0x0, 0x21,0x3a,0x48,0x69,0xdd,0xfd,0x7f,0xff,0xf5,0xf5,0xfa,0xbf,0xff,0xff,0xff,0xbb,0xff,0xfe,0xef,0xff,0xbb,0xbb,0xff,0xff,0xfe,0xa5,0xa2,0xff,0xcc,0x70,0x1c,0xea,0x81,0x8c,0x2, 0xd0,0x2, 0xcc,0x3, 0xc0,0x0, 0xc, 0x4, 0x10,0x2, 0x8c,0x1, 0xf0,0x1e,0xc, 0x2, 0x70,0x49,0x4c,0xc, 0xa0,0xc4,0xc, 0x37,0xbe,0xbd,0x4e,0x51,0x32,0x42,0x8c,0x1d,0xb0,0x83,0xce,0xbb,0xc8,0xd9,0xe2,0xcd,0x39,0x60,0xcc,0x89,0x8c,0xac,0x24,0x30,0x81,0x49,0xff,0xbb,0xab,0xff,0xfe,0xaf,0xff,0xff,0xfd,0x7f,0xff,0x7f,0xff,0xfd,0xff,0xff,0x7f,0x7f,0xf5,0x7f,0xaa,0x8b,0xff,0x4, 0x76,0x3, 0xb1,0x81,0x85,0xc2,0x22,0x1c,0xc4,0xa0,0x6c,0xc3,0x42,0x24,0x40,0x9a,0x18,0xff,0x99,0x98,0x4f,0x5e,0x93,0x1b,0x5c,0xc4,0xb0,0x98,0x2a,0x1, 0x10,0x18,0xf, 0xa0,0x7d,0x98,0x9, 0xc0,0x45,0x18,0x8, 0x60,0x29,0x98,0x5, 0xe0,0xf, 0x98,0x5, 0x80,0x0, 0x9, 0x0, 0x4e,0x9c,0x1e,0x9f,0x6f,0xff,0xfd,0xbf,0xff,0xff,0xfb,0x3f,0xfd,0x1f,0xff,0xf4,0x7f,0xfd,0x1f,0xff,0xff,0xff,0xa4,0xb5,0xb8,0xf2,0x14,0xb6,0xf, 0xc, 0x46,0x23,0x0, 0xe6,0x2b,0x86,0x6, 0x2a,0x93,0x46,0x1a,0x28,0xe6,0xa, 0xe9,0x46,0x0, 0xbf,0xd6,0x26,0x18,0x29,0x33,0xc6,0x0, 0x88,0x45,0xe6,0x0, 0x60,0x1f,0xc6,0x0, 0xd8,0x10,0xe6,0x1, 0x50,0x9, 0x6, 0x1, 0x40,0x2, 0x1, 0xc0,0x2b,0x93,0x0, 0x48,0xa2,0x29,0xe8,0xf6,0x7f,0xff,0xd9,0xd3,0xff,0xff,0xff,0xff,0xd3,0xff,0xff,0x4f,0xff,0xd3,0xff,0xff,0xf4,0xff,0xa2,0x8b,0xff,0x8c,0xc, 0x3d,0xa8,0x14,0x30,0x98,0x8e,0xb, 0x18,0xb4,0x1e,0x98,0xc8,0x51,0x98,0xb2,0xa4,0x18,0xed,0xa3,0x98,0x30,0xbf,0x28,0x1a,0x1, 0x24,0xc7,0x98,0x17,0x21,0x15,0x1
, 0x80,0x7d,0x8a,0x1, 0x0, 0x60,0xc, 0x80,0x7e,0x0},
 {0xff,0xfb,0x92,0x0, 0x8e,0xf, 0xf2,0x7e,0xb, 0xc6,0x3, 0x7f,0xd9,0x30,0x4f,0x1, 0x68,0xc0,0x6f,0xbf,0x24,0x9, 0xe0,0x2d,0x18,0xa, 0xf7,0xe4,0x81,0x1e,0x85,0xa3,0x1, 0xbe,0xfc,0x90,0x60,0x10,0x80,0xa, 0x4c,0x2, 0x81,0x10,0x4, 0xc9,0xe2,0x8e,0x9f,0x6f,0xff,0xfd,0xbd,0x1f,0xff,0xff,0xff,0xfc,0x87,0xff,0xfd,0xa, 0xa2,0xff,0xc8,0x70,0x10,0xea,0x81,0xcc,0x2d,0x4, 0xc, 0x44,0xb, 0x4c,0x5f,0x12,0x8c,0x7b,0x2a,0xc, 0x8c,0x50,0x4c,0xf3,0xc9,0xc, 0x35,0xee,0xde,0xce,0x32,0x42,0x47,0x8c,0x1b,0xc0,0x83,0xcc,0x8, 0xd0,0x3a,0xc, 0x2, 0x60,0x1c,0xc2,0xc0,0x15,0xd, 0x0, 0x50,0x10,0x2, 0x10,0x70,0x3, 0xaa,0x8b,0xff,0xff,0xff,0xb3,0xa7,0xff,0xff,0xff,0xff,0xb7,0xff,0xfe,0xdf,0xff,0xff,0xff,0xfe,0x9a,0x2f,0xfc,0x47,0x43,0x4e,0x84,0x38,0xc2,0xa0,0x6c,0xc4,0x10,0xd8,0xc5,0xc1,0x3c,0xc8,0x22,0x9c,0xca,0x54,0xd0,0xd2,0xeb,0xf4,0xc4,0x3f,0xe2,0x28,0xec,0x2f,0x22,0xac,0xc2,0x37,0x7, 0xc8,0xc0,0xbc,0x3, 0x64,0xc0,0x45,0x1, 0x90,0x28,0x0, 0xe8,0xb0,0x2, 0xc0,0x20,0xd, 0x42,0x0, 0x1a,0x52,0x3f,0xff,0xff,0xfd,0xbd,0x1e,0x8f,0xff,0xff,0xff,0xd9,0xff,0xff,0x67,0xff,0xfd,0x9f,0xff,0xff,0xfa,0x68,0xbf,0xf2,0x1c,0x18,0x38,0x81,0xb3,0x8, 0x42,0x83,0xe, 0x4, 0x53,0x16,0x45,0x43,0x22,0xc9,0xe3,0x31,0x11,0x33,0x60,0x69,0xc3,0x15,0xe3,0x16,0x93,0xe3,0x30,0x79,0x3, 0xb, 0x80,0x1a,0xf3,0x4, 0xc, 0xb, 0x43,0x1, 0xc0,0x4, 0xb3,0x0, 0x6c,0x0, 0x0, 0xa0,0x0, 0xe6,0x0, 0x88,0x1, 0x40,0x60,0x3, 0x55,0xd2,0x7b,0x3f,0xff,0xff,0x67,0x4f,0xff,0xff,0xff,0xff,0x6f,0xff,0xfd,0xbf,0xff,0x67,0x6f,0xff,0xfd,0x3f,0xe8,0xa2,0xfd,0x55,0x21,0x3e,0x7d,0xd0,0x18,0x34,0x17,0x98,0x62,0x25,0x18,0xa4,0x2b,0x99,0x18,0x4b,0x99,0xa6,0x7c,0x1b,0x4d,0x29,0x98,0xc1,0x75,0xfb,0x1f,0xd6,0xe3,0x5c,0x98,0x66,0x20,0xbd,0x18,0x24,0x40,0x4d,0x98,0x10,0xa0,0x1b,0x13,0x0, 0xb2,0x55,0x0, 0x40,0xc0,0x6, 0x0, 0x44,0x4, 0x0, 0x32,0xe9,0x25,0xdb,0xff,0xff,0xff,0x90,0xff,0xff,0xff,0xff,0xec,0xff,0xff,0xb3,0xff,0xed,0xff,0xff,0xfa,0x3f,0xd3,0xbd,0xfb,0xd1,0x21,0xe3,0x84,0x84,0xc0,0xe2,0xc3,0xc, 0x11,0x4c,0x72,0x46,0x33,0xb9,0xb0,0xd8,0x4a,0x53,0xcc,0xdf,0x8c,0x5e,0xc7,0x23,0xcf,0xda,0x21,0x1
, 0x32,0x20,0x3a,0x4c,0x11,0xf0,0x14,0x8c,0x8,0x0},
 {0xff,0xfb,0x92,0x0, 0xb2,0xf, 0xf2,0x5c,0xb, 0x46,0x3, 0x7d,0xf9,0x20,0x4d,0xc1,0x68,0xc0,0x6f,0xbf,0x24,0xa, 0x38,0x2d,0x18,0xd, 0xf7,0xe4,0x81,0x3f,0x85,0xa3,0x1, 0xae,0xfc,0x90,0x80,0x2, 0x4c,0x3, 0x90,0x1, 0x41,0x20,0xc, 0x88,0x40,0x10,0x2d,0xcb,0x5a,0x67,0x67,0xff,0xff,0xfe,0x9f,0xff,0xff,0xff,0xfe,0xdf,0xff,0xfb,0x7f,0xfe,0xcf,0xff,0xff,0xff,0xd1,0x7b,0xff,0x65,0x56,0x4e,0x36,0x81,0x2, 0x73,0x4, 0x8e,0xc, 0x4c,0x39,0x33,0x1, 0x3c,0xd5,0x66,0xc3,0xb8,0x3d,0xcc,0x56,0x74,0xb1,0xf, 0x85,0x70,0xb4,0x4c,0x2d,0xb0,0x23,0xc, 0x10,0x40,0x9, 0xc7,0x80,0xfa,0x30,0xd, 0x80,0xe, 0x30,0x0, 0x0, 0x16,0x24,0x0, 0x3d,0x10,0x9d,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0xcf,0xff,0xff,0xff,0xed,0xff,0xff,0xfa,0xf, 0x6a,0x8, 0xe8,0x7, 0x74,0x74,0x2, 0x60,0xa0,0x7, 0x26,0x0, 0xa8,0x6, 0x6, 0x2, 0xa8,0x6, 0x86,0x5, 0x40,0x5, 0x66,0xb, 0xc8,0x7, 0x86,0x2c,0x90,0x97,0xa7,0xd0,0xd0,0x14,0x46,0x17,0x90,0x0, 0xe1,0xe2,0x33,0x43,0x3, 0xc, 0x82,0x21,0x30,0x68,0x7c,0x2c,0x10,0x45,0xf7,0xab,0x47,0xb5,0x84,0xb6,0x0, 0x1c,0x1d,0x13,0x92,0x8d,0x8c,0x10,0x2b,0x32,0x50,0x84,0x32,0x8c,0x77,0x42,0x11,0x8b,0x1a,0x41,0xc9,0xf3,0xea,0x9, 0x61,0x85,0xe6,0x1, 0xc9,0x82,0x20,0x0, 0xe1,0x81,0x12,0x0, 0xf9,0x80,0x8c,0x1, 0x41,0x80,0x24,0x1, 0x0, 0x14,0x1, 0x14,0x18,0x78,0xdb,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0x84,0xc4,0x14,0xd4,0x53,0x32,0xe3,0x93,0x35,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0xbd,0xfb,0xb8,0x4b,0x1, 0xeb,0x18,0x0, 0x58,0x1, 0x1d,0x88,0xc4,0x80,0xe4,0x31,0xaa,0x88,0xc7,0x95,0x91,0x98,0xc2,0x4b,0xff,0x1f,0xec,0xc1,0xcf,0x98,0x67,0x40,0x65,0x18,0x25,0xe0,0x30,0x98,0x13,0x80,0x21,0x18,0xb, 0x20,0x1f,0x98,0x4, 0x60,0x16,0x98,0x1, 0x80,0xb, 0x3, 0x40,0x1, 0x6b,0xc, 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xd1,0xff,0xff,0x41,0xed,0x61,0x1, 0xd0,0x39,0x47,0x8c,0x12,0x29,0x30,0x50,0xc8,0x42,0x19,0x3, 0x19,0xd, 0x3a,0x73,0x3b,0xf6,0x8, 0xc5,0xcb,0x7b,0x3c,0xfc,0x85,0x12,0xb0,0xc3,0x15,0x4, 0x24,0xc1,0x22,0x1, 0xf0,0xc0,0x99,0x1, 0x44,0xc0,0x58,0x1, 0x10,0xc0,0x24,0x0
,0xc0,0x13,0x0, 0x5c,0xb2,0x8c,0xed,0xbf,0xff,0x0}
};

#endif



void Codec_Interrupter_Handler(void)
{
    static uint8 i = 0;
    //GEK_WRITE_REG(AHB_CODEC_BASE+0x10, 1);
    Gecko_DMA_Transport((void *)(AHB_CODEC_BASE+0x0c), testdata[i++],sizeof(testdata[i])/2, 
        AHB_DMA_CONTROL_HWORD_TR, AHB_DMA_CONTROL_SRC_INC_DES_NOINC);  
		
    if(i>=sizeof(testdata)/sizeof(testdata[0]))
        i=0;
}

#endif






